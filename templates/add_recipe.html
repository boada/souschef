{% extends "base.html" %}

{% block title %}Add Recipe - souschef.ai{% endblock %}

{% block content %}
<div class="page-header">
    <h2>Add New Recipe</h2>
</div>

<div class="form-container">
    <form id="add-recipe-form" onsubmit="addRecipe(event)">
        <div class="form-group">
            <label for="url">Recipe URL</label>
            <input type="url" 
                   id="url" 
                   name="url" 
                   placeholder="https://www.example.com/recipe" 
                   required>
            <small>Paste a URL from any recipe website (AllRecipes, NYT Cooking, Serious Eats, etc.)</small>
        </div>
        
        <button type="submit" class="btn btn-primary" id="submit-btn">
            Add Recipe
        </button>
    </form>
    
    <div id="message" class="message" style="display: none;"></div>
</div>

<div class="info-box">
    <h3>Supported Sites</h3>
    <p>This app supports 100+ recipe websites including:</p>
    <ul>
        <li>AllRecipes</li>
        <li>NYT Cooking</li>
        <li>Serious Eats</li>
        <li>Food Network</li>
        <li>Bon Appétit</li>
        <li>And many more!</li>
    </ul>
</div>

{% endblock %}

{% block scripts %}
<script>
function addRecipe(event) {
    event.preventDefault();
    
    const form = document.getElementById('add-recipe-form');
    const submitBtn = document.getElementById('submit-btn');
    const messageDiv = document.getElementById('message');
    const formData = new FormData(form);
    
    // Show loading state
    submitBtn.disabled = true;
    submitBtn.textContent = 'Adding...';
    messageDiv.style.display = 'none';
    
    fetch('/add-recipe', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Show success message
            messageDiv.className = 'message success';
            messageDiv.textContent = '✓ ' + data.message;
            messageDiv.style.display = 'block';
            
            // Redirect to home page after 1 second
            setTimeout(() => {
                window.location.href = '/';
            }, 1000);
        } else {
            throw new Error(data.error || 'Unknown error');
        }
    })
    .catch(error => {
        messageDiv.className = 'message error';
        messageDiv.textContent = '✗ ' + error.message;
        messageDiv.style.display = 'block';
        
        submitBtn.disabled = false;
        submitBtn.textContent = 'Add Recipe';
    });
}
</script>
{% endblock %}
